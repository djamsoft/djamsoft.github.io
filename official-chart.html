<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>المخطط الرسمي | Djamel Djoulah ASI</title>
    <style>
        :root { --gold: #d4af37; --bg: #000; --cyan: #00ffff; --green: #00ff00; }
        body { background-color: var(--bg); color: white; font-family: 'Arial', sans-serif; margin: 0; display: flex; flex-direction: column; align-items: center; min-height: 100vh; overflow-x: hidden; }
        
        /* القائمة العلوية */
        header { width: 100%; background: #000; padding: 10px 0; display: flex; justify-content: center; gap: 8px; border-bottom: 1px solid #222; position: sticky; top: 0; z-index: 100; }
        .btn-nav { flex: 1; max-width: 115px; padding: 10px 2px; text-align: center; border-radius: 5px; text-decoration: none; font-weight: bold; border: 1px solid #333; color: white; font-size: 13px; background: #111; }
        .active { background: var(--gold); color: black; border: none; }

        #matrix-canvas { position: fixed; top: 0; left: 0; z-index: 1; opacity: 0.15; }
        .wrapper { position: relative; z-index: 10; display: flex; flex-direction: column; align-items: center; width: 100%; max-width: 500px; flex-grow: 1; text-align: center; padding-bottom: 20px; }

        /* المدار والمخطط الرسمي */
        .orbit-container { position: relative; height: 400px; width: 400px; display: flex; align-items: center; justify-content: center; margin: 5px 0; }
        #static-triangle-layer { position: absolute; width: 100%; height: 100%; z-index: 5; pointer-events: none; }
        .fixed-angle { position: absolute; color: var(--gold); font-weight: bold; font-size: 24px; text-shadow: 0 0 15px var(--gold); z-index: 10; }
        
        .rotating-layer { position: absolute; width: 100%; height: 100%; animation: rotate-slow 120s linear infinite; z-index: 4; }
        .orbit-number { position: absolute; top: 50%; left: 50%; color: var(--cyan); font-family: monospace; font-size: 10px; font-weight: bold; opacity: 0.6; }

        .main-numbers { font-size: 78px; color: var(--gold); font-weight: bold; text-shadow: 0 0 25px var(--gold); z-index: 20; position: absolute; }
        
        /* صندوق معادلة الـ 29 */
        .deduction-box { color: var(--green); font-size: 14px; margin: 5px 0; border: 1px dashed var(--green); padding: 8px 15px; border-radius: 10px; background: rgba(0, 40, 0, 0.3); }

        .tasbih-box { background: rgba(10, 30, 10, 0.85); padding: 8px 25px; border-radius: 50px; display: flex; align-items: center; gap: 15px; border: 1px solid #1b5e20; margin: 10px 0; }
        #count { font-size: 28px; width: 50px; height: 50px; border-radius: 50%; border: 2px solid #1b5e20; display: flex; align-items: center; justify-content: center; }
        .allah-btn { font-size: 24px; color: #4caf50; background: none; border: none; cursor: pointer; font-weight: bold; }
        .play-btn { font-size: 22px; color: var(--gold); cursor: pointer; background: none; border: none; }

        .equation { color: var(--green); font-size: 24px; font-family: monospace; margin: 10px 0; font-weight: bold; }
        
        /* زر الاستنباط */
        .btn-action { background: var(--gold); color: black; padding: 12px 40px; border-radius: 50px; font-size: 20px; font-weight: bold; border: none; cursor: pointer; margin: 15px 0; box-shadow: 0 0 15px rgba(212, 175, 55, 0.4); }

        /* التذييل الكامل مع السطر المفقود */
        footer { width: 100%; padding: 30px 0; background: rgba(0,0,0,0.95); border-top: 1px solid #222; margin-top: auto; }
        .footer-name { font-size: 42px; font-weight: bold; color: white; margin: 0; line-height: 1; text-transform: uppercase; }
        .footer-sub { color: var(--gold); font-size: 20px; margin: 10px 0; }
        .footer-desc { color: var(--green); font-size: 15px; font-weight: bold; margin-top: 8px; }

        @keyframes rotate-slow { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        .fast-rotate { animation-duration: 4s !important; }
    </style>
</head>
<body>
    <canvas id="matrix-canvas"></canvas>

    <header>
        <a href="index.html" class="btn-nav">الرئيسية</a>
        <a href="official-chart.html" class="btn-nav active">المخطط الرسمي</a>
        <a href="loyalty.html" class="btn-nav">محراب الوفاء</a>
    </header>

    <div class="wrapper">
        <div style="color: var(--gold); font-size: 26px; margin-top: 20px; font-weight: bold;">بِسْمِ اللهِ الرَّحْمَنِ الرَّحِيمِ</div>

        <div class="orbit-container">
            <svg id="static-triangle-layer" viewBox="0 0 400 400">
                <polygon id="key-triangle" points="" fill="none" stroke="rgba(212, 175, 55, 0.7)" stroke-width="2" stroke-dasharray="8,4" />
            </svg>
            <div id="fixed-angles-container"></div> 
            <div class="rotating-layer" id="orbit"></div>
            <div class="main-numbers">38 71 82</div>
        </div>

        <div style="color: var(--gold); font-size: 22px; margin-bottom: 5px;">۞ كِتَابٌ مَرْقُومٌ ۞</div>

        <div class="deduction-box">
            Σ (الآحاد + العشرات) = 29 سورة (الأحرف المقطعة)
        </div>

        <div class="tasbih-box">
            <button class="play-btn" onclick="togglePlay()" id="playIcon">▶</button>
            <button class="allah-btn" onclick="add()">الله</button>
            <div id="count">0</div>
        </div>

        <div class="equation">191 = (19 × 10) + 1</div>

        <button class="btn-action" onclick="activateLogic()">تفعيل الاستنباط</button>

        <footer>
            <p class="footer-name">DJAMEL DJOULAH<br>ASI</p>
            <p class="footer-sub">الباحث: جمال جولاح</p>
            <p class="footer-desc">المخطط الرسمي للأحرف | "كِتَابٌ مَرْقُومٌ"</p>
        </footer>
    </div>

    <audio id="audioQuran" loop><source src="https://server11.mp3quran.net/yasser/083.mp3" type="audio/mpeg"></audio>

    <script>
        const orbit = document.getElementById('orbit');
        const angleContainer = document.getElementById('fixed-angles-container');
        const triangle = document.getElementById('key-triangle');
        const radius = 170;
        let points = [];

        for (let i = 1; i <= 114; i++) {
            const angle = (i / 114) * (Math.PI * 2) - (Math.PI / 2);
            const x = Math.cos(angle) * radius;
            const y = Math.sin(angle) * radius;

            const span = document.createElement('span');
            span.className = 'orbit-number';
            span.innerText = i;
            span.style.left = `calc(50% + ${x}px)`;
            span.style.top = `calc(50% + ${y}px)`;
            orbit.appendChild(span);

            if ([38, 71, 82].includes(i)) {
                const fixedAngle = document.createElement('div');
                fixedAngle.className = 'fixed-angle';
                fixedAngle.innerText = i;
                const xF = Math.cos(angle) * (radius + 30);
                const yF = Math.sin(angle) * (radius + 30);
                fixedAngle.style.left = `calc(50% + ${xF}px)`;
                fixedAngle.style.top = `calc(50% + ${yF}px)`;
                fixedAngle.style.transform = 'translate(-50%, -50%)';
                angleContainer.appendChild(fixedAngle);
                points.push(`${200 + x},${200 + y}`);
            }
        }
        triangle.setAttribute('points', points.join(' '));

        function activateLogic() {
            const layer = document.getElementById('orbit');
            layer.classList.add('fast-rotate');
            setTimeout(() => { layer.classList.remove('fast-rotate'); }, 4000);
        }

        const canvas = document.getElementById('matrix-canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth; canvas.height = window.innerHeight;
        const drops = Array(Math.floor(canvas.width/20)).fill(1);
        function draw() {
            ctx.fillStyle = "rgba(0, 0, 0, 0.1)"; ctx.fillRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = "#00ffff"; ctx.font = "14px monospace";
            drops.forEach((y, i) => {
                ctx.fillText(Math.floor(Math.random()*10), i*20, y*20);
                if (y*20 > canvas.height && Math.random() > 0.98) drops[i] = 0;
                drops[i]++;
            });
        }
        setInterval(draw, 50);

        function add() { document.getElementById('count').innerText = parseInt(document.getElementById('count').innerText) + 1; }
        function togglePlay() {
            const audio = document.getElementById('audioQuran');
            const btn = document.getElementById('playIcon');
            audio.paused ? (audio.play(), btn.innerText = "⏸") : (audio.pause(), btn.innerText = "▶");
        }
    </script>
</body>
</html>
