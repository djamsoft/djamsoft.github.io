<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø±ÙƒØ² Ø§Ù„ÙØ­Øµ Ø§Ù„Ø³ÙŠØ§Ø¯ÙŠ | SYSTEM DJOULAH ASI</title>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;900&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/jsxgraph/distrib/jsxgraph.css" />
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/jsxgraph/distrib/jsxgraphcore.js"></script>
    
    <style>
        :root { --cyan: #00dfd8; --gold: #d4af37; --bg: #0b0e14; --card: #151921; }
        body { font-family: 'Tajawal', sans-serif; background: var(--bg); color: white; margin: 0; text-align: center; }
        header { background: linear-gradient(135deg, #1a2a6c, #0b0e14); padding: 40px 20px; border-bottom: 4px solid var(--gold); }
       .main-title { font-size: 3rem; font-weight: 900; color: var(--cyan); text-shadow: 0 0 25px var(--cyan); margin: 0; }
        nav { background: #151921; padding: 15px; display: flex; justify-content: center; gap: 20px; border-bottom: 1px solid #333; position: sticky; top: 0; z-index: 1000; }
        nav a { color: white; text-decoration: none; font-weight: bold; padding: 8px 15px; border-radius: 5px; }
       .active { background: var(--cyan); color: black!important; }
       .main-container { max-width: 1100px; margin: 30px auto; display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 25px; padding: 0 20px; }
       .box { background: var(--card); border: 1px solid #333; padding: 30px; border-radius: 20px; text-align: right; border-right: 5px solid var(--gold); }
        #jgraph { width: 100%; height: 300px; background: #000; border-radius: 15px; margin-top: 15px; border: 1px solid #2d333f; }
        label { display: block; margin: 15px 0 5px; font-size: 0.9rem; color: #ccc; }
        input, textarea, select { width: 100%; padding: 12px; border-radius: 10px; border: 1px solid #444; background: #000; color: white; box-sizing: border-box; }
       .btn-analyze { width: 100%; padding: 15px; margin-top: 20px; border-radius: 10px; border: none; font-weight: bold; cursor: pointer; background: var(--cyan); color: black; font-size: 1.1rem; }
       .btn-action { margin-top: 10px; background: transparent; border: 2px solid var(--gold); color: var(--gold); }
        #result-panel { margin: 20px auto; max-width: 900px; padding: 30px; background: #fff; color: #333; display: none; border-radius: 15px; text-align: right; }
    </style>
</head>
<body>

    <header>
        <h1 class="main-title">SYSTEM DJOULAH ASI</h1>
        <div style="font-size: 1.4rem; color: var(--gold); font-weight: 700;">Ù…Ø±ÙƒØ² Ø§Ù„ÙØ­Øµ ÙˆØ§Ù„ØªØ¯Ù‚ÙŠÙ‚ Ø§Ù„Ø¥Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠ | Ø«Ø§Ø¨Øª Ø¬ÙˆÙ„Ø§Ø­ Ø§Ù„ÙƒÙˆÙ†ÙŠ 19</div>
    </header>

    <nav>
        <a href="index.html">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
        <a href="inspection_center.html" class="active">Ù…Ø±ÙƒØ² Ø§Ù„ÙØ­Øµ</a>
        <a href="loyalty.html">Ù…Ø­Ø±Ø§Ø¨ Ø§Ù„ÙˆÙØ§Ø¡</a>
        <a href="core.html">Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø°ÙƒÙŠ</a>
    </nav>

    <div class="main-container">
        <div class="box">
            <h3 style="color: var(--cyan);">ğŸ”¬ ÙˆØ­Ø¯Ø© Ø§Ù„ÙØ­Øµ ÙˆØ§Ù„ØªØ­Ù„ÙŠÙ„</h3>
            <label>Ø§Ù„Ù…Ø¹Ø·Ù‰ Ø§Ù„Ù…Ø±Ø§Ø¯ ÙØ­ØµÙ‡ (Ø·Ø¨ÙŠ/Ø¥Ø¯Ø§Ø±ÙŠ/ØªÙ‚Ù†ÙŠ):</label>
            <input type="text" id="inputData" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø£Ùˆ Ø§Ù„ÙƒÙˆØ¯...">
            <label>Ø¨Ø±ÙŠØ¯ Ø§Ù„Ù…Ø³ØªÙ„Ù… Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù†ØªØ§Ø¦Ø¬:</label>
            <input type="email" id="userEmail" placeholder="example@mail.com">
            <button class="btn-analyze" onclick="runAnalysis()">ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø³ÙŠØ§Ø¯ÙŠØ©</button>
        </div>

        <div class="box">
            <h3 style="color: var(--gold);">âš–ï¸ Ù…ÙŠØ²Ø§Ù† Ø¬ÙˆÙ„Ø§Ø­ Ø§Ù„Ø§Ø­ØªÙ…Ø§Ù„ÙŠ</h3>
            <div id="jgraph" class="jxgbox"></div>
            <button class="btn-analyze btn-action" onclick="downloadPDF()">â¬‡ï¸ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙ‚Ø±ÙŠØ± (PDF)</button>
            <button class="btn-analyze btn-action" style="border-color:var(--cyan); color:var(--cyan);" onclick="sendEmail()">ğŸ“§ Ø¥Ø±Ø³Ø§Ù„ Ø¹Ø¨Ø± Ø§Ù„Ø¨Ø±ÙŠØ¯</button>
        </div>
    </div>

    <div id="result-panel">
        <div style="text-align: center; border-bottom: 3px solid #1a2a6c; padding-bottom: 10px; margin-bottom: 20px;">
            <h2>ÙˆØ«ÙŠÙ‚Ø© Ø§Ù„ÙØ­Øµ Ø§Ù„ÙˆÙ‚Ø§Ø¦ÙŠ ÙˆØ§Ù„Ø­Ù„ÙˆÙ„ Ø§Ù„Ø¥Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ©</h2>
            <h3>Djamel Djoulah ASI</h3>
        </div>
        <p><strong>Ù…Ø±Ø¬Ø¹ Ø§Ù„Ù†Ø¸Ø§Ù…:</strong> Ø«Ø§Ø¨Øª Ø¬ÙˆÙ„Ø§Ø­ Ø§Ù„ÙƒÙˆÙ†ÙŠ 19</p>
        <p><strong>Ø§Ù„Ù…Ø¹Ø·ÙŠØ§Øª Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©:</strong> <span id="out-data"></span></p>
        <p><strong>Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø§Ù„Ø¥Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠ:</strong> ØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø¨Ø±ÙˆØªÙˆÙƒÙˆÙ„ "Ø§Ù„ØµÙØ± Ø®Ø·Ø£". Ø§Ù„Ù†Ø¸Ø§Ù… ÙŠÙ‚ØªØ±Ø­ Ø§ØªØ¨Ø§Ø¹ Ø§Ù„Ù…Ø®Ø·Ø· Ø§Ù„ÙˆÙ‚Ø§Ø¦ÙŠ Ø§Ù„Ù…Ø±ÙÙ‚ Ù„Ø¶Ù…Ø§Ù† ØªØ­Ù‚ÙŠÙ‚ Ø§Ù„Ø£Ù‡Ø¯Ø§Ù Ø§Ù„Ø³ÙŠØ§Ø¯ÙŠØ©.</p>
        <p style="text-align: center; margin-top: 40px; font-size: 0.8rem;">Djoualhya El Kouif Tebessa | Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±</p>
    </div>

    <script>
        // 1. ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ
        const board = JXG.JSXGraph.initBoard('jgraph', {boundingbox: [-5, 25, 25, -5], axis:true, showCopyright:false});
        board.create('point', [19, 19], {name:'Ø«Ø§Ø¨Øª 19', color:'gold', fixed:true});
        board.create('functiongraph', [function(x){ return Math.pow(x, 2)/19; }, 0, 25], {strokeColor:'#00dfd8'});

        // 2. ØªÙØ¹ÙŠÙ„ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        function runAnalysis() {
            const data = document.getElementById('inputData').value;
            if(!data) return alert("ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø£ÙˆÙ„Ø§Ù‹");
            document.getElementById('out-data').innerText = data;
            document.getElementById('result-panel').style.display = 'block';
            alert("ØªÙ…Øª Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø© Ù…Ø¹ Ø«Ø§Ø¨Øª Ø¬ÙˆÙ„Ø§Ø­ 19 Ø¨Ù†Ø¬Ø§Ø­.");
        }

        // 3. ÙˆØ¸ÙŠÙØ© ØªØ­Ù…ÙŠÙ„ PDF (Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†)
        function downloadPDF() {
            const element = document.getElementById('result-panel');
            if(element.style.display === 'none') return alert("Ù‚Ù… Ø¨Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„ÙØ­Øµ Ø£ÙˆÙ„Ø§Ù‹");
            const opt = { margin: 10, filename: 'ASI_Sovereign_Report.pdf', jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' } };
            html2pdf().set(opt).from(element).save();
        }

        // 4. ÙˆØ¸ÙŠÙØ© Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨Ø±ÙŠØ¯ (Ù„Ù„Ù…Ø¹Ù†ÙŠÙŠÙ†)
        function sendEmail() {
            const email = document.getElementById('userEmail').value;
            if(!email) return alert("ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø¨Ø±ÙŠØ¯ Ø§Ù„Ù…Ø³ØªÙ„Ù…");
            
            // ØªØ­ÙˆÙŠÙ„ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø¥Ù„Ù‰ Base64 Ù„Ø¥Ø±Ø³Ø§Ù„Ù‡ ÙƒÙ…Ù„Ø­Ù‚ Ø¹Ø¨Ø± EmailJS
            const element = document.getElementById('result-panel');
            html2pdf().from(element).outputPdf('datauristring').then(function(pdfBase64) {
                // Ù…Ù„Ø§Ø­Ø¸Ø©: ÙŠØ¬Ø¨ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¹Ø±ÙØ§Øª EmailJS Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ Ù‡Ù†Ø§ Ù„ØªØ¹Ù…Ù„ Ø§Ù„ÙˆØ¸ÙŠÙØ©
                const serviceID = 'default_service';
                const templateID = 'template_asi';
                const templateParams = {
                    to_email: email,
                    message: 'Ù…Ø±ÙÙ‚ ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙØ­Øµ Ø§Ù„ÙˆÙ‚Ø§Ø¦ÙŠ Ù…Ù† Ù†Ø¸Ø§Ù… Djamel Djoulah ASI',
                    content_pdf: pdfBase64 // ÙŠØ¬Ø¨ Ø¶Ø¨Ø· Ø§Ù„Ù‚Ø§Ù„Ø¨ ÙÙŠ EmailJS Ù„Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø§Ù„Ù…Ø±ÙÙ‚
                };
                
                alert("Ø¬Ø§Ø±ÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø¥Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠ Ø¥Ù„Ù‰ " + email + " Ø¹Ø¨Ø± Ø¨ÙˆØ§Ø¨Ø© ASI Ø§Ù„Ø¢Ù…Ù†Ø©...");
                // emailjs.send(serviceID, templateID, templateParams).then(...);
            });
        }
    </script>
</body>
</html>
